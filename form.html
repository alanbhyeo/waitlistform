<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Person Details Form</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="form-container">
        <div class="form-wrapper">
            <h1>Person Details Form</h1>
            <p class="subtitle">Please fill in your information below</p>
            
            <form id="personDetailsForm" novalidate>
                <div class="form-group">
                    <label for="firstName">First Name <span class="required">*</span></label>
                    <input 
                        type="text" 
                        id="firstName" 
                        name="firstName" 
                        required 
                        placeholder="Enter your first name"
                    >
                    <span class="error-message" id="firstNameError"></span>
                </div>

                <div class="form-group">
                    <label for="lastName">Last Name <span class="required">*</span></label>
                    <input 
                        type="text" 
                        id="lastName" 
                        name="lastName" 
                        required 
                        placeholder="Enter your last name"
                    >
                    <span class="error-message" id="lastNameError"></span>
                </div>

                <div class="form-group">
                    <label for="email">Email Address <span class="required">*</span></label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        required 
                        placeholder="your.email@example.com"
                    >
                    <span class="error-message" id="emailError"></span>
                </div>

                <div class="form-group">
                    <label for="phone">Mobile <span class="required">*</span></label>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone" 
                        required 
                        placeholder="04XX XXX XXX"
                        pattern="^04\d{2}\s\d{3}\s\d{3}$"
                        maxlength="12"
                    >
                    <span class="error-message" id="phoneError"></span>
                </div>

                <div class="form-group">
                    <label for="dateOfBirth">Date of Birth</label>
                    <input 
                        type="date" 
                        id="dateOfBirth" 
                        name="dateOfBirth"
                    >
                    <span class="error-message" id="dateOfBirthError"></span>
                </div>

                <div class="form-group">
                    <label for="streetAddress">Street Address</label>
                    <input 
                        type="text" 
                        id="streetAddress" 
                        name="streetAddress" 
                        placeholder="123 Main Street"
                    >
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="city">City</label>
                        <input 
                            type="text" 
                            id="city" 
                            name="city" 
                            placeholder="City"
                        >
                    </div>

                    <div class="form-group">
                        <label for="state">State</label>
                        <select 
                            id="state" 
                            name="state"
                        >
                            <option value="">Select State</option>
                            <option value="NSW">NSW</option>
                            <option value="VIC">VIC</option>
                            <option value="QLD">QLD</option>
                            <option value="ACT">ACT</option>
                            <option value="NT">NT</option>
                            <option value="WA">WA</option>
                            <option value="TAS">TAS</option>
                            <option value="SA">SA</option>
                        </select>
                        <span class="error-message" id="stateError"></span>
                    </div>

                    <div class="form-group">
                        <label for="zipCode">Postcode</label>
                        <input 
                            type="text" 
                            id="zipCode" 
                            name="zipCode" 
                            placeholder="1234"
                        >
                        <span class="error-message" id="zipCodeError"></span>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="submit-button" id="submitButton">
                        <span class="button-text">Submit</span>
                        <span class="button-loader" id="buttonLoader" style="display: none;">‚è≥</span>
                    </button>
                    <button type="reset" class="reset-button">Clear Form</button>
                </div>

                <div id="formMessage" class="form-message" style="display: none;"></div>
            </form>
        </div>
    </div>

    <!-- Supabase JS Library - Using unpkg CDN as alternative -->
    <script src="https://unpkg.com/@supabase/supabase-js@2.39.3/dist/umd/index.js"></script>
    
    <!-- Supabase Configuration -->
    <script src="supabase-config.js"></script>
    
    <!-- Phone Number Formatting Script -->
    <script>
        // Phone number formatting: 04XX XXX XXX
        document.addEventListener('DOMContentLoaded', function() {
            const phoneInput = document.getElementById('phone');
            
            if (phoneInput) {
                phoneInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\s/g, ''); // Remove all spaces
                    
                    // Only allow digits
                    value = value.replace(/\D/g, '');
                    
                    // Ensure it starts with 04
                    if (value.length > 0 && !value.startsWith('04')) {
                        if (value.startsWith('4')) {
                            value = '0' + value;
                        } else {
                            value = '04' + value.replace(/^0*/, '');
                        }
                    }
                    
                    // Limit to 10 digits (04XX XXX XXX)
                    if (value.length > 10) {
                        value = value.substring(0, 10);
                    }
                    
                    // Format: 04XX XXX XXX
                    let formatted = '';
                    if (value.length > 0) {
                        formatted = value.substring(0, 4); // 04XX
                        if (value.length > 4) {
                            formatted += ' ' + value.substring(4, 7); // XXX
                        }
                        if (value.length > 7) {
                            formatted += ' ' + value.substring(7, 10); // XXX
                        }
                    }
                    
                    e.target.value = formatted;
                });
                
                // Validate phone number on blur
                phoneInput.addEventListener('blur', function(e) {
                    const value = e.target.value.replace(/\s/g, '');
                    const phoneError = document.getElementById('phoneError');
                    
                    if (value.length > 0 && value.length !== 10) {
                        phoneError.textContent = 'Phone number must be in format 04XX XXX XXX';
                    } else if (value.length > 0 && !value.startsWith('04')) {
                        phoneError.textContent = 'Phone number must start with 04';
                    } else {
                        phoneError.textContent = '';
                    }
                });
                
                // Clear error on input
                phoneInput.addEventListener('input', function() {
                    const phoneError = document.getElementById('phoneError');
                    const value = this.value.replace(/\s/g, '');
                    if (value.length === 10 && value.startsWith('04')) {
                        phoneError.textContent = '';
                    }
                });
            }
        });
    </script>
    
    <!-- Form Handler -->
    <script src="form-handler.js"></script>
</body>
</html>
